version: "3.9"
services:
  telegram-bot:
    build: 
      context: ..
      dockerfile: docker/Dockerfile
    image: hsayfi/overseerr-telegram-bot:latest
    container_name: overseerr-telegram-bot
    environment:
      # Required: Overseerr API configuration
      OVERSEERR_API_URL: "http://YOUR_IP_ADDRESS:5055/api/v1"
      OVERSEERR_API_KEY: "YOUR_OVERSEERR_API_KEY"
      
      # Required: Telegram Bot Token
      TELEGRAM_TOKEN: "YOUR_TELEGRAM_TOKEN"
      
      # Optional: Access control (leave empty for no password)
      PASSWORD: "YOUR_PASSWORD"
      
      # Optional: Bot mode (normal, api, shared) - default: normal
      BOT_MODE: "normal"
      
      # Optional: Python environment
      PYTHONPATH: "/app"
      
    volumes:
      # Persistent data storage for sessions, configs, etc.
      - ../data:/app/data
      
    restart: unless-stopped
    
    # Health check
    healthcheck:
      test: ["CMD", "python", "-c", "import os, sys, time; health_file = '/app/data/bot_health.txt'; exit(1) if not os.path.exists(health_file) else exit(1) if time.time() - os.path.getmtime(health_file) > 120 else exit(0)"]
      interval: 60s
      timeout: 10s
      retries: 3
      start_period: 30s
    
    # Logging configuration
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
